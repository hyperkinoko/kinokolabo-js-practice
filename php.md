# ユーザ定義関数とは?

ユーザ定義関数とは、PHPに予め用意された関数ではなく、自分で新しく作った（定義した）関数のことを言います。  
PHPに用意された関数は、呼び出すだけで使えますが、ユーザ定義関数は「定義」しないと使えません。

では関数とは何でしょう？  
関数は、処理のまとまりに名前をつけたものです。

例えば、カレーを作る手順を考えてみましょう。  
大ざっぱに言えば、下のような4つの手順になるでしょう。

1. 野菜と肉を下ごしらえする
2. 鍋に肉と野菜を入れて煮込む
3. カレールゥを入れて煮込む
4. 皿に炊いたご飯を盛り、3のカレーをかける

これをユーザ定義関数風に定義してみましょう（あくまでも「風」です）

```
function カレーを作る() {
    野菜と肉を下ごしらえする();
    鍋に肉と野菜を入れて煮込む;
    カレールゥを入れて煮込む;
    皿に炊いたご飯を盛り、3のカレーをかける;
}
```

phpでは、ユーザ定義関数の「定義」を以下のように書きます。

```
<?php
    function 関数名(引数1, 引数2, ...) {
        なにかの処理;
        なにかの処理;
             ・
             ・
             ・
        return 戻り値;
    }
?>
```
`function`の後ろに関数名を書きます。「何をするか」を定義するので、動詞を使うことが多いです。
`()`の中には引数を書きますが、引数がない、つまり何も書かないこともあります。
`return`の後ろには戻り値を書きますが、戻り値がない、つまりこの行がないものもあります。

この「定義」はあくまでも、「カレーを作るとはこういうことをしますよ」という、レシピのようなものなので、実行しないとカレーはできません。  
実行するには、

```
カレーを作る();
```

と呼び出す必要があります。  
定義と呼び出しは必ずセットになります。

一旦定義しておくと何度でも呼び出せるところも「ユーザ定義関数」のいいところです。

```
カレーを作る();
カレーを作る();
カレーを作る();
```

こうすると、3回、カレーを作ることができます。

ところで、「カレーを作る」の中身を確認すると、「野菜と肉を下ごしらえする」の中にも、細かい作業が隠れていますね。

1. じゃがいもを下ごしらえする
2. 人参を下ごしらえする
3. 玉ねぎを下ごしらえする
4. 肉を下ごしらえする

この4つの作業をまとめて「野菜と肉を下ごしらえする」と表せそうです。

さらに、「じゃがいもを下ごしらえする」は

1. じゃがいもを洗う
2. じゃがいもの皮をむく
3. じゃがいもを一口大に切る

と、もっと細かく表現できますね。

これをユーザ定義関数風に書いてみると、

```
function じゃがいもを下ごしらえする() {
    じゃがいもを洗う
    じゃがいもの皮をむく
    じゃがいもを一口大に切る
}
```

こんな感じに表現できます。

では、人参を下ごしらえする関数も書いてみましょう。

```
function 人参を下ごしらえする() {
    人参を洗う
    人参の皮をむく
    人参を一口大に切る
}
```

じゃがいもの下ごしらえとよく似ていますね。

同じようなコードを書くことは、少し無駄な気がします。  
人参やじゃがいもを「野菜」と表現できないでしょうか？

```
function 野菜を下ごしらえする(野菜) {
    野菜を洗う
    野菜の皮をむく
    野菜を一口大に切る
}
```

これでじゃがいもも人参も、同じように下ごしらえできそうです。

ここで、`(野菜)`と書いていることに注目してください。  
これが引数です。
野菜を洗うと言っても、実際にはじゃがいもなのか、人参なのか、定義の部分だけではわかりませんね。  
これを解決するため、引数に「野菜」を設定しておき、呼び出す側で人参なのか、じゃがいもなのかを指定することができるのです。

```
野菜を下ごしらえする(じゃがいも);
野菜を下ごしらえする(人参);
```

さて、「カレーを作る」の関数をもう一度見直すと、「炊いたご飯」というのがいきなり出てきます。  
ちゃんと炊いたご飯を受け取りたいですね・・・。「戻り値」の出番です。

```
function ご飯を炊く() {
    米を洗う;
    米を浸水する;
    米を鍋に入れて炊く;
    return 炊きあがった米;
}
```

このように、「戻り値」を設定してあげると、炊きあがった米を受け取ることができます。

```
$炊いたご飯 = ご飯を炊く();

function カレーを作る() {
    野菜と肉を下ごしらえする();
    鍋に肉と野菜を入れて煮込む;
    カレールゥを入れて煮込む;
    皿に$炊いたご飯を盛り、3のカレーをかける;
}
```
これで、いざ盛り付ける時にご飯ができていない心配もなくなりました。

まとめると、以下のようなコードになります（あくまでもphp「風」です）

```
カレーを作る();

function カレーを作る() {
    $炊いたご飯 = ご飯を炊く();

    野菜と肉を下ごしらえする();
    鍋に肉と野菜を入れて煮込む;
    カレールゥを入れて煮込む;
    皿に$炊いたご飯を盛り、3のカレーをかける;
}

function 野菜と肉を下ごしらえする() {
    野菜を下ごしらえする(じゃがいも);
    野菜を下ごしらえする(人参);
    野菜を下ごしらえする(玉ねぎ);
    肉を下ごしらえする;
}

function 野菜を下ごしらえする(野菜) {
    野菜を洗う
    野菜の皮をむく
    野菜を一口大に切る
}

function ご飯を炊く() {
    米を洗う;
    米を浸水する;
    米を鍋に入れて炊く;
    return 炊きあがった米;
}
```
